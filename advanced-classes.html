<!DOCTYPE html>
<head>
<meta charset=utf-8>
<title>Advanced Classes - Dive into Python 3</title>
<!--[if IE]><script src=j/html5.js></script><![endif]-->
<link rel=stylesheet href=dip3.css>
<style>
body{counter-reset:h1 11}
</style>
<link rel=stylesheet media='only screen and (max-device-width: 480px)' href=mobile.css>
<link rel=stylesheet media=print href=print.css>
<meta name=viewport content='initial-scale=1.0'>
</head>
<form action=http://www.google.com/cse><div><input type=hidden name=cx value=014021643941856155761:l5eihuescdw><input type=hidden name=ie value=UTF-8>&nbsp;<input name=q size=25>&nbsp;<input type=submit name=sa value=Search></div></form>
<p>You are here: <a href=index.html>Home</a> <span class=u>&#8227;</span> <a href=table-of-contents.html#advanced-classes>Dive Into Python 3</a> <span class=u>&#8227;</span>
<p id=level>Difficulty level: <span title=advanced>&#x2666;&#x2666;&#x2666;&#x2666;&#x2662;</span>
<h1>Advanced Classes</h1>
<blockquote class=q>
<p><span class=u>&#x275D;</span> FIXME <span class=u>&#x275E;</span><br>&mdash; FIXME
</blockquote>
<p id=toc>&nbsp;
<h2 id=divingin>Diving In</h2>
<p class=f>FIXME

<h2 id=ordereddict>Ordered Dictionary: Not An Oxymoron</h2>

<p>[FIXME here's why ordered dicts are useful: http://www.gossamer-threads.com/lists/python/dev/656556 ]

<p class=d>[<a href=examples/ordereddict.py>download <code>ordereddict.py</code></a>]
<pre><code class=pp>import collections
import itertools
 
class OrderedDict(dict, collections.MutableMapping):

    def __init__(self, *args, **kwds):
        if len(args) > 1:
            raise TypeError('expected at most 1 arguments')
        if not hasattr(self, '_keys'):
            self._keys = []
        self.update(*args, **kwds)

    def clear(self):
        del self._keys[:]
        dict.clear(self)

    def __setitem__(self, key, value):
        if key not in self:
            self._keys.append(key)
        dict.__setitem__(self, key, value)

    def __delitem__(self, key):
        dict.__delitem__(self, key)
        self._keys.remove(key)

    def __iter__(self):
        return iter(self._keys)

    def __reversed__(self):
        return reversed(self._keys)

    def popitem(self):
        if not self:
            raise KeyError('dictionary is empty')
        key = self._keys.pop()
        value = dict.pop(self, key)
        return key, value

    def __reduce__(self):
        items = [[k, self[k]] for k in self]
        inst_dict = vars(self).copy()
        inst_dict.pop('_keys', None)
        return (self.__class__, (items,), inst_dict)

    setdefault = MutableMapping.setdefault
    update = MutableMapping.update
    pop = MutableMapping.pop
    keys = MutableMapping.keys
    values = MutableMapping.values
    items = MutableMapping.items

    def __repr__(self):
        if not self:
            return '{0}()'.format(self.__class__.__name__,)
        return '{0}({1})'.format(self.__class__.__name__, repr(list(self.items())))

    def copy(self):
        return self.__class__(self)

    @classmethod
    def fromkeys(cls, iterable, value=None):
        d = cls()
        for key in iterable:
            d[key] = value
        return d

    def __eq__(self, other):
        if isinstance(other, OrderedDict):
            return all(p==q for p, q in itertools.zip_longest(self.items(), other.items()))
        return dict.__eq__(self, other)</code></pre>

<p class=a>&#x2042;

<h2 id=class-attributes>Attributes of a Class Object</h2>

<p>FIXME

<pre class=screen>
<samp class=p>>>> </samp><kbd>import ordereddict</kbd>
<samp class=p>>>> </samp><kbd>od = ordereddict.OrderedDict()</kbd>
<a><samp class=p>>>> </samp><kbd>klass = od.__class__</kbd>       <span class=u>&#x2460;</span></a>
<samp class=p>>>> </samp><kbd>type(klass)</kbd>
<samp>&lt;class 'abc.ABCMeta'></samp>
<samp class=p>>>> </samp><kbd>klass.__name__</kbd>
<samp>'OrderedDict'</samp>
<!--
<samp class=p>>>> </samp><kbd>klass.__doc__</kbd>
<samp>FIXME</samp>
-->
<samp class=p>>>> </samp><kbd>klass.__module__</kbd>
<samp>'ordereddict'</samp>
<samp class=p>>>> </samp><kbd>klass.__bases__</kbd>
<samp>(&lt;class 'dict'>, &lt;class '_abcoll.MutableMapping'>)</samp></pre>
<ol>
<li>FIXME
</ol>

<pre class=screen>
# continued from previous example
<samp class=p>>>> </samp><kbd>klass.__dict__</kbd>
<samp>{'__abstractmethods__': frozenset(),
 '__delitem__': &lt;function __delitem__ at 0x00DCB6A8>,
 '__dict__': &lt;attribute '__dict__' of 'OrderedDict' objects>,
 '__doc__': None,
 '__eq__': &lt;function __eq__ at 0x00DD2930>,
 '__hash__': None,
 '__init__': &lt;function __init__ at 0x00DC41E0>,
 '__iter__': &lt;function __iter__ at 0x00DCB618>,
 '__module__': 'ordereddict',
 '__reduce__': &lt;function __reduce__ at 0x00DCB6F0>,
 '__repr__': &lt;function __repr__ at 0x00DCB8E8>,
 '__reversed__': &lt;function __reversed__ at 0x00DCB660>,
 '__setitem__': &lt;function __setitem__ at 0x00DCB5D0>,
 '__weakref__': &lt;attribute '__weakref__' of 'OrderedDict' objects>,
 '_abc_cache': &lt;_weakrefset.WeakSet object at 0x00DCF950>,
 '_abc_negative_cache': &lt;_weakrefset.WeakSet object at 0x00DCF990>,
 '_abc_negative_cache_version': 12,
 '_abc_registry': &lt;_weakrefset.WeakSet object at 0x00DCF910>,
 'clear': &lt;function clear at 0x00DCB7C8>,
 'copy': &lt;function copy at 0x00DD28A0>,
 'fromkeys': &lt;classmethod object at 0x00DCF8F0>,
 'items': &lt;function items at 0x00D60150>,
 'keys': &lt;function keys at 0x00D60108>,
 'pop': &lt;function pop at 0x00D60978>,
 'popitem': &lt;function popitem at 0x00DCB780>,
 'setdefault': &lt;function setdefault at 0x00D60A98>,
 'update': &lt;function update at 0x00D60A50>,
 'values': &lt;function values at 0x00D60198>}</samp></pre>
<ol>
<li>FIXME
</ol>

<p class=a>&#x2042;

<h2 id=implementing-fractions>Implementing Fractions</h2>

<p class=v><a rel=prev class=todo><span class=u>&#x261C;</span></a> <a rel=next class=todo><span class=u>&#x261E;</span></a>
<p class=c>&copy; 2001&ndash;9 <a href=about.html>Mark Pilgrim</a>
<script src=j/jquery.js></script>
<script src=j/prettify.js></script>
<script src=j/dip3.js></script>
